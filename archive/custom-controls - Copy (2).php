<?php  if(class_exists('WP_Customize_Control')){class DIYM_Google_Font_Select2 extends WP_Customize_Control{public function __construct($manager,$id,$args=array(),$options=array()){parent::__construct($manager,$id,$args);}public function enqueue(){}public function render_content(){ ?> <li id="customize-control-<?php echo esc_html($this->id); ?>" class="customize-control customize-control-google-font-select2" style="display: list-item">Hello World</li> <?php }}class Skyrocket_Custom_Control extends WP_Customize_Control{protected function get_skyrocket_resource_url(){if(strpos(wp_normalize_path(__DIR__),wp_normalize_path(WP_PLUGIN_DIR))===0){return plugin_dir_url(__DIR__);}return trailingslashit(get_template_directory_uri());}}class Skyrocket_Dropdown_Select2_Custom_Control extends Skyrocket_Custom_Control{public $type='dropdown_select2';private $multiselect=false;private $placeholder='Please select...';public function __construct($manager,$id,$args=array(),$options=array()){parent::__construct($manager,$id,$args);if(isset($this->input_attrs['multiselect'])&&$this->input_attrs['multiselect']){$this->multiselect=true;}if(isset($this->input_attrs['placeholder'])&&$this->input_attrs['placeholder']){$this->placeholder=$this->input_attrs['placeholder'];}}public function enqueue(){wp_enqueue_script('diym-select2-js',DIYM_JS_URL.'select2.js',array('jquery'),'4.0.13',true);wp_enqueue_script('diym-custom-controls-js',DIYM_JS_URL.'customizer.js',['diym-select2-js'],DIYM_VER,true);wp_enqueue_style('diym-custom-controls-css',DIYM_CSS_URL.'customizer.css',array(),'1.1','all');wp_enqueue_style('diym-select2-css',DIYM_CSS_URL.'select2.css',array(),'4.0.13','all');}public function render_content(){$defaultValue=$this->value();if($this->multiselect){$defaultValue=explode(',',$this->value());} ?> <div class="dropdown_select2_control"> <?php if(!empty($this->label)){ ?> <label for="<?php echo esc_attr($this->id); ?>" class="customize-control-title"> <?php echo esc_html($this->label); ?> </label> <?php } ?> <?php if(!empty($this->description)){ ?> <span class="customize-control-description"><?php echo esc_html($this->description); ?></span> <?php } ?> <input type="hidden" id="<?php echo esc_attr($this->id); ?>" class="customize-control-dropdown-select2" value="<?php echo esc_attr($this->value()); ?>" name="<?php echo esc_attr($this->id); ?>" <?php $this->link(); ?> > <select name="select2-list-<?php echo($this->multiselect?'multi[]':'single'); ?>" class="customize-control-select2" data-placeholder="<?php echo $this->placeholder; ?>" <?php echo($this->multiselect?'multiple="multiple" ':''); ?>> <?php  if(!$this->multiselect){echo '<option></option>';}foreach($this->choices as $key =>$value){if(is_array($value)){echo '<optgroup label="'.esc_attr($key).'">';foreach($value as $optgroupkey =>$optgroupvalue){if($this->multiselect){echo '<option value="'.esc_attr($optgroupkey).'" '.(in_array(esc_attr($optgroupkey),$defaultValue)?'selected="selected"':'').'>'.esc_attr($optgroupvalue).'</option>';}else{echo '<option value="'.esc_attr($optgroupkey).'" '.selected(esc_attr($optgroupkey),$defaultValue,false).'>'.esc_attr($optgroupvalue).'</option>';}}echo '</optgroup>';}else{if($this->multiselect){echo '<option value="'.esc_attr($key).'" '.(in_array(esc_attr($key),$defaultValue)?'selected="selected"':'').'>'.esc_attr($value).'</option>';}else{echo '<option value="'.esc_attr($key).'" '.selected(esc_attr($key),$defaultValue,false).'>'.esc_attr($value).'</option>';}}} ?> </select></div> <?php }}class Skyrocket_Google_Font_Select_Custom_Control extends Skyrocket_Custom_Control{public $type='google_fonts';private $fontList=false;private $fontValues=[];private $fontListIndex=0;private $fontCount='all';private $fontOrderBy='alpha';public function __construct($manager,$id,$args=array(),$options=array()){parent::__construct($manager,$id,$args);if(isset($this->input_attrs['orderby'])&&strtolower($this->input_attrs['orderby'])==='popular'){$this->fontOrderBy='popular';}if(isset($this->input_attrs['font_count'])){if('all' !=strtolower($this->input_attrs['font_count'])){$this->fontCount=(abs((int) $this->input_attrs['font_count'])>0?abs((int) $this->input_attrs['font_count']):'all');}}$this->fontList=$this->skyrocket_getGoogleFonts('all');$this->fontValues=json_decode($this->value());$this->fontListIndex=$this->skyrocket_getFontIndex($this->fontList,$this->fontValues->font);}public function enqueue(){wp_enqueue_script('diym-select2-js',DIYM_JS_URL.'select2.js',['jquery'],'4.0.13',true);wp_enqueue_script('diym-custom-controls-js',DIYM_JS_URL.'customizer.js',['diym-select2-js'],DIYM_VER,true);wp_enqueue_style('diym-custom-controls-css',DIYM_CSS_URL.'customizer.css',[],DIYM_VER,'all');wp_enqueue_style('diym-select2-css',DIYM_CSS_URL.'select2.css',[],'4.0.13','all');}public function to_json(){parent::to_json();$this->json['skyrocketfontslist']=$this->fontList;}public function render_content(){$fontCounter=0;$isFontInList=false;$fontListStr='';if(!empty($this->fontList)){ ?> <div class="google_fonts_select_control"> <?php if(!empty($this->label)){ ?> <span class="customize-control-title"><?php echo esc_html($this->label); ?></span> <?php } ?> <?php if(!empty($this->description)){ ?> <span class="customize-control-description"><?php echo esc_html($this->description); ?></span> <?php } ?> <input type="hidden" id="<?php echo esc_attr($this->id); ?>" name="<?php echo esc_attr($this->id); ?>" value="<?php echo esc_attr($this->value()); ?>" class="customize-control-google-font-selection" <?php $this->link(); ?> ><div class="google-fonts"><select class="google-fonts-list" control-name="<?php echo esc_attr($this->id); ?>"> <?php  foreach($this->fontList as $key =>$value){$fontCounter++;$fontListStr .='<option value="'.$value->family.'" '.selected($this->fontValues->font,$value->family,false).'>'.$value->family.'</option>';if($this->fontValues->font ===$value->family){$isFontInList=true;}if(is_int($this->fontCount)&&$fontCounter ===$this->fontCount){break;}}if(!$isFontInList &&$this->fontListIndex){$fontListStr='<option value="'.$this->fontList[$this->fontListIndex]->family.'" '.selected($this->fontValues->font,$this->fontList[$this->fontListIndex]->family,false).'>'.$this->fontList[$this->fontListIndex]->family.' (default)</option>'.$fontListStr;}echo $fontListStr; ?> </select></div><div class="customize-control-description"><?php esc_html_e('Select weight & style for regular text','skyrocket') ?></div><div class="weight-style"><select class="google-fonts-regularweight-style"> <?php  foreach($this->fontList[$this->fontListIndex]->variants as $key =>$value){echo '<option value="'.$value.'" '.selected($this->fontValues->regularweight,$value,false).'>'.$value.'</option>';} ?> </select></div><div class="customize-control-description"><?php esc_html_e('Select weight for','skyrocket') ?> <italic><?php esc_html_e('italic text','skyrocket') ?></italic></div><div class="weight-style"><select class="google-fonts-italicweight-style" <?php disabled(in_array('italic',$this->fontList[$this->fontListIndex]->variants),false); ?>> <?php  $optionCount=0;foreach($this->fontList[$this->fontListIndex]->variants as $key =>$value){if(strpos($value,'italic')!==false){echo '<option value="'.$value.'" '.selected($this->fontValues->italicweight,$value,false).'>'.$value.'</option>';$optionCount++;}}if($optionCount ==0){echo '<option value="">Not Available for this font</option>';} ?> </select></div><div class="customize-control-description"><?php esc_html_e('Select weight for','skyrocket') ?> <strong><?php esc_html_e('bold text','skyrocket') ?></strong></div><div class="weight-style"><select class="google-fonts-boldweight-style"> <?php  $optionCount=0;foreach($this->fontList[$this->fontListIndex]->variants as $key =>$value){if(strpos($value,'italic')===false){echo '<option value="'.$value.'" '.selected($this->fontValues->boldweight,$value,false).'>'.$value.'</option>';$optionCount++;}}if($optionCount ==0){echo '<option value="">Not Available for this font</option>';} ?> </select></div><input type="hidden" class="google-fonts-category" value="<?php echo $this->fontValues->category; ?>"></div> <?php }}public function skyrocket_getFontIndex($haystack,$needle){foreach($haystack as $key =>$value){if($value->family ==$needle){return $key;}}return false;}public function skyrocket_getGoogleFonts($count=30){$fontFile=DIYM_URL.'inc/google-fonts-alphabetical.json';if($this->fontOrderBy ==='popular'){$fontFile=DIYM_URL.'inc/google-fonts-popularity.json';}$request=wp_remote_get($fontFile);if(is_wp_error($request)){return "";}$body=wp_remote_retrieve_body($request);$content=json_decode($body);if($count =='all'){return $content->items;}else{return array_slice($content->items,0,$count);}}}if(!function_exists('skyrocket_google_font_sanitization')){function skyrocket_google_font_sanitization($input){$val=json_decode($input,true);if(is_array($val)){foreach($val as $key =>$value){$val[$key]=sanitize_text_field($value);}$input=json_encode($val);}else{$input=json_encode(sanitize_text_field($val));}return $input;}}} ?>